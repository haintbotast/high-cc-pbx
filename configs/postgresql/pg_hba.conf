# =============================================================================
# PostgreSQL Client Authentication Configuration
# =============================================================================

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections (Unix socket)
local   all             postgres                                peer
local   all             all                                     peer

# Replication connections (for standby)
host    replication     replicator      172.16.91.101/32        scram-sha-256
host    replication     replicator      172.16.91.102/32        scram-sha-256

# VoIP application connections
host    kamailio        kamailio        172.16.91.101/32        scram-sha-256
host    kamailio        kamailio        172.16.91.102/32        scram-sha-256
host    kamailio        kamailio        172.16.91.100/32        scram-sha-256  # VIP

host    voip            voipadmin       172.16.91.101/32        scram-sha-256
host    voip            voipadmin       172.16.91.102/32        scram-sha-256
host    voip            voipadmin       172.16.91.100/32        scram-sha-256  # VIP

# FreeSWITCH connections (ODBC)
host    voip            freeswitch      172.16.91.101/32        scram-sha-256
host    voip            freeswitch      172.16.91.102/32        scram-sha-256
host    voip            freeswitch      172.16.91.100/32        scram-sha-256  # VIP

# Localhost (for monitoring, admin)
host    all             all             127.0.0.1/32            scram-sha-256
host    all             all             ::1/128                 scram-sha-256

# Reject all other connections
host    all             all             0.0.0.0/0               reject
