<!-- =============================================================================
     Sofia SIP Configuration
     ============================================================================= -->

<configuration name="sofia.conf" description="Sofia SIP Configuration">
  <global_settings>
    <param name="log-level" value="0"/>
    <param name="auto-restart" value="true"/>
    <param name="debug-presence" value="0"/>
    <param name="rtp-enable-zrtp" value="false"/>
    <param name="sip-trace" value="no"/>
  </global_settings>

  <profiles>
    <!-- Internal profile (from Kamailio) -->
    <profile name="internal">
      <aliases>
        <alias name="default"/>
      </aliases>

      <settings>
        <param name="sip-ip" value="192.168.1.101"/>  <!-- Change per node -->
        <param name="sip-port" value="5080"/>
        <param name="rtp-ip" value="192.168.1.101"/>  <!-- Change per node -->
        <param name="context" value="default"/>
        <param name="dialplan" value="XML"/>

        <!-- Performance -->
        <param name="max-proceeding" value="3000"/>
        <param name="session-timeout" value="1800"/>

        <!-- RTP -->
        <param name="rtp-timeout-sec" value="300"/>
        <param name="rtp-hold-timeout-sec" value="1800"/>

        <!-- Codec preferences -->
        <param name="inbound-codec-prefs" value="OPUS,PCMU,PCMA,G729"/>
        <param name="outbound-codec-prefs" value="OPUS,PCMU,PCMA,G729"/>
        <param name="inbound-codec-negotiation" value="generous"/>

        <!-- Auth (disabled - Kamailio handles this) -->
        <param name="auth-calls" value="false"/>
        <param name="accept-blind-auth" value="true"/>

        <!-- Registration (disabled - Kamailio handles this) -->
        <param name="manage-presence" value="false"/>

        <!-- NAT -->
        <param name="NDLB-received-in-nat-reg-contact" value="true"/>
        <param name="NDLB-force-rport" value="true"/>
        <param name="ext-rtp-ip" value="auto-nat"/>
        <param name="ext-sip-ip" value="auto-nat"/>

        <!-- Call recording -->
        <param name="record-path" value="/var/lib/freeswitch/recordings"/>
        <param name="record-waste-resources" value="false"/>

        <!-- TLS (optional) -->
        <!-- <param name="tls" value="true"/> -->
        <!-- <param name="tls-cert-dir" value="/etc/freeswitch/tls"/> -->
      </settings>
    </profile>
  </profiles>
</configuration>
