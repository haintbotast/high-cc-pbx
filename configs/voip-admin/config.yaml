# =============================================================================
# VoIP Admin Service Configuration
# Description: Unified API Gateway + Admin Service
# =============================================================================

server:
  host: "0.0.0.0"
  port: 8080
  read_timeout: 30s
  write_timeout: 30s
  idle_timeout: 120s

database:
  host: "192.168.1.100"      # VIP address
  port: 5432
  user: "voipadmin"
  password: "CHANGE_ME"
  dbname: "voip"
  sslmode: "disable"

  # Connection pool
  max_open_conns: 50
  max_idle_conns: 25
  conn_max_lifetime: 300s    # 5 minutes

  # Schema
  search_path: "voip,kamailio"

# In-memory cache for extensions/directory
cache:
  enabled: true
  ttl: 300s                   # 5 minutes
  cleanup_interval: 600s      # 10 minutes
  max_entries: 10000

# FreeSWITCH integration
freeswitch:
  # Event Socket Layer (ESL)
  esl:
    host: "127.0.0.1"
    port: 8021
    password: "ClueCon2025ChangeMe"
    timeout: 5s

  # XML_CURL endpoints (served by this service)
  xml_curl:
    enabled: true
    auth_user: "freeswitch"
    auth_pass: "API_KEY_HERE"

# CDR processing
cdr:
  # Background workers
  workers: 4
  batch_size: 100
  poll_interval: 5s

  # Retry logic
  max_retries: 3
  retry_delay: 30s

# API authentication
api:
  # API keys for external systems
  keys:
    - name: "freeswitch"
      key: "API_KEY_HERE"
      permissions: ["xml_curl", "cdr"]

    - name: "admin"
      key: "ADMIN_API_KEY_HERE"
      permissions: ["read", "write", "admin"]

# Logging
logging:
  level: "info"              # debug, info, warn, error
  format: "json"             # json or text
  output: "stdout"           # stdout or file path
  file:
    path: "/var/log/voip-admin/voip-admin.log"
    max_size: 100            # MB
    max_backups: 10
    max_age: 30              # days
    compress: true

# Metrics (Prometheus)
metrics:
  enabled: true
  path: "/metrics"
  port: 9090

# Health check
health:
  enabled: true
  path: "/health"

# CORS (if accessed from web UI)
cors:
  enabled: true
  allowed_origins:
    - "http://localhost:3000"
    - "https://admin.example.com"
  allowed_methods:
    - "GET"
    - "POST"
    - "PUT"
    - "DELETE"
  allowed_headers:
    - "Authorization"
    - "Content-Type"

# Performance tuning
performance:
  max_goroutines: 1000
  request_timeout: 30s
  shutdown_timeout: 30s
